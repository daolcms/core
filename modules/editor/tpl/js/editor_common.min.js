function editorGetContent(e){var t=editorRelKeys[e]["func"](e);var n=new RegExp(request_uri.replace(/\//g,"\\/")+"(files|common|modules|layouts|widgets)","ig");return t.replace(n,"$1")}function editorFocus(e){try{var t=editorGetIFrame(e);if(jQuery.isFunction(t.setFocus)){t.setFocus()}else{t.contentWindow.focus()}}catch(n){}}function editorEnableAutoSave(e,t,n){var r=e.title.value;var i=editorRelKeys[t]["content"].value;editorAutoSaveObj={fo_obj:e,editor_sequence:t,title:r,content:i,locked:false};clearTimeout(editorEnableAutoSave.timer);editorEnableAutoSave.timer=setTimeout(function(){_editorAutoSave(false,n)},5e4)}function _editorAutoSave(e,t){var n=editorAutoSaveObj.fo_obj;var r=editorAutoSaveObj.editor_sequence;if(!e){clearTimeout(editorEnableAutoSave.timer);editorEnableAutoSave.timer=setTimeout(function(){_editorAutoSave(e,t)},5e4)}if(editorAutoSaveObj.locked==true)return;if(!n||typeof n.title=="undefined"||!r)return;var i=n.title.value;var s="";try{s=editorGetContent(r)}catch(o){}if(i!=editorAutoSaveObj.title||s!=editorAutoSaveObj.content||e){var u,a=new Date;u={title:i,content:s,mid:current_mid,document_srl:editorRelKeys[r]["primary"].value};editorAutoSaveObj.title=i;editorAutoSaveObj.content=s;jQuery("#editor_autosaved_message_"+r).text(a.getHours()+":"+a.getMinutes()+" "+auto_saved_msg).show(300);editorAutoSaveObj.locked=true;show_waiting_message=false;exec_xml("editor","procEditorSaveDoc",u,function(){var e=jQuery.extend({},u,{auto_saved_msg:auto_saved_msg});editorAutoSaveObj.locked=false;if(jQuery.isFunction(t))t(e)});show_waiting_message=true}}function editorRemoveSavedDoc(){var e=new Array;e["mid"]=current_mid;exec_xml("editor","procEditorRemoveSavedDoc",e)}function editorGetIFrame(e){if(editorRelKeys!=undefined&&editorRelKeys[e]!=undefined&&editorRelKeys[e]["editor"]!=undefined)return editorRelKeys[e]["editor"].getFrame(e);return document.getElementById("editor_iframe_"+e)}function editorGetTextarea(e){return document.getElementById("editor_textarea_"+e)}function eOptionOver(e){e.style.marginTop="-21px";e.style.zIndex="99"}function eOptionOut(e){e.style.marginTop="0";e.style.zIndex="1"}function eOptionClick(e){e.style.marginTop="-42px";e.style.zIndex="99"}function editorEventCheck(e){editorPrevNode=null;var t=e.target.id;if(!t)return;var n=t.split("_");if(n[0]!="component")return;var r=n[1];var i=t.replace(/^component_[0-9]+_/,"");if(!r||!i)return;if(editorMode[r]=="html")return;switch(i){case"Bold":case"Italic":case"Underline":case"StrikeThrough":case"undo":case"redo":case"JustifyLeft":case"JustifyCenter":case"JustifyRight":case"JustifyFull":case"Indent":case"Outdent":case"InsertOrderedList":case"InsertUnorderedList":case"SaveAs":case"Print":case"Copy":case"Cut":case"Paste":case"RemoveFormat":case"Subscript":case"Superscript":editorDo(i,"",r);break;default:openComponent(i,r);return false}return}function openComponent(e,t,n){editorPrevSrl=t;if(editorMode[t]=="html")return;var r=request_uri+"?module=editor&act=dispEditorPopup&editor_sequence="+t+"&component="+e;if(typeof n!="undefined"&&n)r+="&manual_url="+escape(n);if(typeof current_mid!="undefined"&&current_mid)r+="&mid="+escape(current_mid);popopen(r,"editorComponent")}function editorSearchComponent(e){var t=new xEvent(e);editorPrevNode=null;var n=t.target;if(n.getAttribute("widget")){var r=n;while(r&&r.nodeName!="BODY"){r=xParent(r)}if(!r||r.nodeName!="BODY"||!r.getAttribute("editor_sequence")){editorPrevNode=null;return}var i=r.getAttribute("editor_sequence");var s=n.getAttribute("widget");editorPrevNode=n;if(editorMode[i]=="html")return;popopen(request_uri+"?module=widget&act=dispWidgetGenerateCodeInPage&selected_widget="+s+"&module_srl="+i,"GenerateCodeInPage");return}if(!n.getAttribute("editor_component")){while(n&&!n.getAttribute("editor_component")){if(n.parentElement)n=n.parentElement;else n=xParent(n)}}if(!n)n=t.target;var o=n.getAttribute("editor_component");if(!o){if(n.nodeName=="IMG"&&!n.getAttribute("widget")){o="image_link";editorPrevNode=n}}else{editorPrevNode=n}if(!o){editorPrevNode=null;return}var r=n;while(r&&r.nodeName!="BODY"){r=xParent(r)}if(!r||r.nodeName!="BODY"||!r.getAttribute("editor_sequence")){editorPrevNode=null;return}var i=r.getAttribute("editor_sequence");openComponent(o,i)}function editorReplaceHTML(e,t){var n=/src=("|\'){1}(\.\/)?(files\/attach|files\/cache|files\/faceOff|files\/member_extra_info|modules|common|widgets|widgetstyle|layouts|addons)\/([^"\']+)\.(jpg|jpeg|png|gif)("|\'){1}/g;t=t.replace(n,'src="'+request_uri+'$3/$4.$5"');var r=/href=("|\'){1}(\.\/)?\?([^"\']+)("|\'){1}/g;t=t.replace(r,'href="'+request_uri+'?$3"');var i=e.editor_sequence||e.contentWindow.document.body.getAttribute("editor_sequence");try{e.contentWindow.focus()}catch(s){}if(jQuery.isFunction(e.replaceHTML)){e.replaceHTML(t)}else if(xIE4Up){var o=e.contentWindow.document.selection.createRange();if(o.pasteHTML){o.pasteHTML(t)}else if(editorPrevNode){editorPrevNode.outerHTML=t}}else{try{if(e.contentWindow.getSelection().focusNode.tagName=="HTML"){var o=e.contentDocument.createRange();o.setStart(e.contentDocument.body,0);o.setEnd(e.contentDocument.body,0);o.insertNode(o.createContextualFragment(t))}else{var o=e.contentWindow.getSelection().getRangeAt(0);o.deleteContents();o.insertNode(o.createContextualFragment(t))}}catch(s){xInnerHtml(e.contentWindow.document.body,t+xInnerHtml(e.contentWindow.document.body))}}}function editorGetSelectedHtml(e){var t=editorGetIFrame(e);if(jQuery.isFunction(t.getSelectedHTML)){return t.getSelectedHTML()}else if(xIE4Up){var n=t.contentWindow.document.selection.createRange();var r=n.htmlText;return r}else{var n=t.contentWindow.getSelection().getRangeAt(0);var i=xCreateElement("div");i.appendChild(n.cloneContents());var r=xInnerHtml(i);return r}}var editorMode=new Array;var editorAutoSaveObj={fo_obj:null,editor_sequence:0,title:"",content:"",locked:false};var editorRelKeys=new Array;var editorDragObj={isDrag:false,y:0,obj:null,id:"",det:0,source_height:0};editorEnableAutoSave.timer=null;var editorPrevSrl=null;jQuery(document).click(editorEventCheck);var editorPrevNode=null;(function(e){function u(u){var f=e(u.target);var l=f.attr("id");if(!l||!/^editor_drag_bar_(.+)$/.test(l))return;t=true;n=u.pageY;s=f;i=RegExp.$1;var c=e(editorGetIFrame(i));var h=e(editorGetTextarea(i));var p=e("#editor_preview_"+i);var d=c.is(":visible")?c:h;r=parseInt(d.css("height"));o=e([c[0],h[0]]);if(p.length)o.add(p[0]);if(!isNaN(r)||!r){var v=d[0].offsetHeight;d.css("height",v+"px");var m=d[0].offsetHeight;r=v*2-m;o.css("height",r+"px")}e("#xeEditorMask_"+i).show();e(document).mousemove(a);return false}function a(s){if(!t){e("#xeEditorMask_"+i).hide();return}var u=s.pageY-n;o.css("height",r+u+"px");return false}function f(u){e("#xeEditorMask_"+i).hide();if(!t)return;e(document).unbind("mousemove",a);if(e.isFunction(window.fixAdminLayoutFooter)){var f=parseInt(o.eq(0).css("height"))-r;fixAdminLayoutFooter(f)}t=false;n=0;s=null;o=null;i="";return false}var t=false;var n=0;var r=0;var i="";var s=null;var o=null})(jQuery)